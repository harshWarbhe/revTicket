<div class="manage-movies-container">
  <div class="admin-page-header">
    <div class="admin-header-background"></div>
    <div class="admin-header-content">
      <div class="admin-header-text">
        <h1>Manage Movies</h1>
        <p>View and manage all movies in your theater</p>
      </div>
      <div class="admin-header-actions">
        <button class="btn-primary" routerLink="/admin/add-movie">
          <span class="icon">+</span>
          Add New Movie
        </button>
      </div>
    </div>
  </div>

  <div class="filters-section">
    <div class="search-box">
      <input 
        type="text" 
        placeholder="Search movies..." 
        [(ngModel)]="searchTerm">
      <span class="search-icon">üîç</span>
    </div>
    
    <div class="filter-controls">
      <select [(ngModel)]="selectedGenre">
        <option value="">All Genres</option>
        <option *ngFor="let genre of availableGenres()" [value]="genre">{{ genre }}</option>
      </select>
      
      <select [(ngModel)]="selectedRating">
        <option value="">All Ratings</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
      </select>
    </div>
  </div>

  <div class="loading-state" *ngIf="loading()">
    <div class="spinner"></div>
    <p>Loading movies...</p>
  </div>

  <div class="movies-grid" *ngIf="!loading() && filteredMovies().length > 0">
    <div class="movie-card" *ngFor="let movie of filteredMovies()">
      <div class="movie-poster">
        <img 
          [src]="movie.posterUrl || 'assets/images/movies/default-poster.png'" 
          [alt]="movie.title"
          (error)="onImageError($event)">
        <div class="movie-overlay">
          <div class="movie-actions">
            <button class="action-btn edit" (click)="editMovie(movie)">
              <span class="icon">‚úèÔ∏è</span>
            </button>
            <button 
              class="action-btn delete" 
              (click)="deleteMovie(movie)"
              [disabled]="deletingId() === movie.id">
              <span class="icon">{{ deletingId() === movie.id ? '‚è≥' : 'üóëÔ∏è' }}</span>
            </button>
          </div>
        </div>
      </div>
      
      <div class="movie-info">
        <div class="movie-header">
          <h3>{{ movie.title }}</h3>
          <button 
            class="status-toggle" 
            [class.active]="movie.isActive"
            (click)="toggleMovieStatus(movie)"
            [title]="movie.isActive ? 'Deactivate' : 'Activate'">
            {{ movie.isActive ? '‚úì' : '‚úó' }}
          </button>
        </div>
        <div class="movie-meta">
          <span class="genre" *ngFor="let g of movie.genre">{{ g }}</span>
          <span class="rating">{{ movie.rating }}/10</span>
          <span class="duration">{{ movie.duration }}m</span>
        </div>
        <p class="description">{{ (movie.description || 'No description available') | slice:0:100 }}{{ movie.description && movie.description.length > 100 ? '...' : '' }}</p>
        
        <div class="movie-stats">
          <div class="stat">
            <span class="label">Shows:</span>
            <span class="value">{{ getShowCount(movie.id) }}</span>
          </div>
          <div class="stat">
            <span class="label">Bookings:</span>
            <span class="value">{{ getBookingCount(movie.id) }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="!loading() && filteredMovies().length === 0">
    <div class="empty-icon">üé¨</div>
    <h3>No Movies Found</h3>
    <p>{{ searchTerm() || selectedGenre() || selectedRating() ? 'Try adjusting your filters' : 'Start by adding your first movie' }}</p>
    <button class="btn-primary" routerLink="/admin/add-movie" *ngIf="!searchTerm() && !selectedGenre() && !selectedRating()">
      Add First Movie
    </button>
  </div>
</div>