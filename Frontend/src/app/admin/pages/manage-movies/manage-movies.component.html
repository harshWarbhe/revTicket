<div class="manage-movies-page">
  <!-- Header -->
  <header class="page-header">
    <div class="header-left">
      <h1 class="page-title">Manage Movies</h1>
      <p class="page-subtitle">Create, edit, and manage all movies</p>
    </div>
    <div class="header-actions">
      <button class="btn-secondary" [class.active]="showInactive()" (click)="toggleInactiveFilter()">
        {{ showInactive() ? 'Hide Inactive' : 'Show Inactive' }}
      </button>
      <button class="btn-primary" routerLink="/admin/add-movie">
        <span>+</span>
        <span>Add New Movie</span>
      </button>
    </div>
  </header>

  <!-- Filters -->
  <section class="filters-section">
    <div class="search-box">
      <span class="search-icon">üîç</span>
      <input type="text" placeholder="Search movies..." [ngModel]="searchTerm()"
        (ngModelChange)="searchTerm.set($event)">
    </div>

    <select [ngModel]="selectedGenre()" (ngModelChange)="selectedGenre.set($event)" class="filter-select">
      <option value="">All Genres</option>
      @for (genre of availableGenres(); track $index) {
      <option [value]="genre">{{ genre }}</option>
      }
    </select>
  </section>

  <!-- Loading State -->
  @if (loading()) {
  <div class="loading-state">
    <div class="spinner"></div>
    <p>Loading movies...</p>
  </div>
  }

  <!-- Movies Table -->
  @if (!loading() && filteredMovies().length > 0) {
  <div class="movies-table">
    <!-- Table Header -->
    <div class="table-header">
      <div class="col-poster">Poster</div>
      <div class="col-title">Title</div>
      <div class="col-crew">Crew / Director</div>
      <div class="col-genre">Genre</div>
      <div class="col-duration">Duration</div>
      <div class="col-rating">Rating</div>
      <div class="col-status">Status</div>
      <div class="col-actions">Actions</div>
    </div>

    <!-- Table Rows -->
    @for (movie of filteredMovies(); track trackById($index, movie)) {
    <div class="table-row">
      <div class="col-poster">
        <img [src]="movie.posterUrl || 'assets/images/movies/default-poster.png'" [alt]="movie.title"
          (error)="onImageError($event)">
      </div>

      <div class="col-title">
        <div class="movie-title">{{ movie.title }}</div>
        <div class="movie-date">{{ formatReleaseDate(movie.releaseDate) }}</div>
      </div>

      <div class="col-crew">
        {{ getDirector(movie) }}
      </div>

      <div class="col-genre">
        {{ movie.genre.length > 0 ? movie.genre.join(', ') : 'N/A' }}
      </div>

      <div class="col-duration">
        {{ movie.duration }} min
      </div>

      <div class="col-rating">
        <span class="rating-pill">{{ movie.rating != null ? (movie.rating | number:'1.1-1') : 'N/A' }}</span>
      </div>

      <div class="col-status">
        <span class="status-pill" [class.active]="movie.isActive">
          {{ movie.isActive ? 'Active' : 'Inactive' }}
        </span>
      </div>

      <div class="col-actions">
        <button class="action-btn edit" (click)="editMovie(movie)" title="Edit">
          ‚úèÔ∏è
        </button>
        <button class="action-btn" [class.deactivate]="movie.isActive" [class.activate]="!movie.isActive"
          (click)="toggleMovieStatus(movie)" [disabled]="deletingId() === movie.id"
          [title]="movie.isActive ? 'Deactivate' : 'Activate'">
          {{ movie.isActive ? 'üö´' : '‚úì' }}
        </button>
      </div>
    </div>
    }
  </div>
  }

  <!-- Empty State -->
  @if (!loading() && filteredMovies().length === 0) {
  <div class="empty-state">
    <div class="empty-icon">üé¨</div>
    <h3>No Movies Found</h3>
    <p>{{ searchTerm() || selectedGenre() ? 'Try adjusting your filters' : 'Start by adding your first movie' }}</p>
    @if (!searchTerm() && !selectedGenre()) {
    <button class="btn-primary" routerLink="/admin/add-movie">
      <span>+</span>
      <span>Add First Movie</span>
    </button>
    }
  </div>
  }
</div>